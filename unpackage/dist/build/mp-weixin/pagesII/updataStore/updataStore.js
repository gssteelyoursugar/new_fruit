(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesII/updataStore/updataStore"],{"0d35":function(e,t,s){},2299:function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return a}));var a={tuiListCell:function(){return s.e("components/tui-list-cell/tui-list-cell").then(s.bind(null,"174d"))}},r=function(){var e=this,t=e.$createElement;e._self._c},i=[]},"365d":function(e,t,s){"use strict";(function(e){s("abd2");a(s("66fd"));var t=a(s("60b5"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("543d")["createPage"])},"60b5":function(e,t,s){"use strict";s.r(t);var a=s("2299"),r=s("e089");for(var i in r)"default"!==i&&function(e){s.d(t,e,(function(){return r[e]}))}(i);s("ff4e");var n,d=s("f0c5"),o=Object(d["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],n);t["default"]=o.exports},"6eec":function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s("09cc"),r=s("0efb"),i=e.getStorageSync("usermen"),n=console,d=n.log,o=s("7ea5"),l=s("d90d"),u={data:function(){return{selectList:o,multiArray:[],value:[0,0,0],text1:"请选择店铺所处省市区",id:"",idAddress:"",addressAllData:[],addressOne:[],addressTwo:[],addressThree:[],textAddress:"",Address1:"",idArrList:"",urlListFlag:[!1,!1,!1,!1],urlList:[],arrId:[],imgName:["门头照","水果陈列照","卸货区","工商营业执照"],imgDataLi:[{title:"门头照片",name:"me_1",url:""},{title:"水果陈列照片",name:"me_2",url:""},{title:"卸货区",name:"me_3",url:""},{title:"工商营业执照",name:"me_4",url:""}],imgUrlData0:"../../static/images/B@2x.png",imgUrlData1:"../../static/images/B@2x.png",imgUrlData2:"../../static/images/B@2x.png",imgUrlData3:"../../static/images/B@2x.png",updataImg0:"",updataImg1:"",updataImg2:"",updataImg3:"",imagesList:[{url:"../../static/images/B@2x.png"},{url:"../../static/images/B@2x.png"},{url:"../../static/images/B@2x.png"},{url:"../../static/images/B@2x.png"}],storeName:"请填写店铺名",merchantsName:"填写姓名",phone:"请输入收货人手机号码",address:"南宁",serviceNumber:"",files:[],imageList:[],category:"image",ctx:{},StoreInfo:{},cartIds:[],imgUrlData:"",addressDetails:"请填写详细地址",flag:!1}},methods:{picker:function(e){console.log("pick=============",e);var t=e.detail.value,s=this.addressOne[t[0]],a=this.addressTwo[t[1]],r=this.addressThree[t[2]];this.text1=s.name+" "+a.name+" "+r.name;var i=this.getAddressById(r.id);d(r);var n=this.getAddressById(i.pId),o=this.getAddressById(n.pId);console.log("addThree===",i.name),console.log("addTwo===",n.name),console.log("addOne===",o.name),this.textAddress=o.name+"/"+n.name+"/"+i.name,console.log("选中的三级信息======",this.textAddress),this.address=r.id,this.StoreInfo.address=this.textAddress,this.idAddress=r.id,d("选中的三级ID======",this.idAddress),this.StoreInfo.address=this.textAddress,this.Address1=this.idAddress},toArr:function(e){var t=[];for(var s in e)t.push(e[s].name);return t},columnPicker:function(e){var t=e.detail.column,s=e.detail.value;if(0===t){var a=this.addressOne[s];console.log("选中的一级===",a.name);var r=this.getAddressByPId(a.id),i=this.getAddressByPId(r[0].id);this.addressTwo=r,this.addressThree=i,this.multiArray=[this.multiArray[0],this.toArr(r),this.toArr(i)],this.value=[s,0,0],d(this.value)}else if(1===t){var n=this.addressTwo[s];console.log("选中的二级===",n.name);var o=this.getAddressByPId(n.id);this.addressThree=o,this.multiArray=[this.multiArray[0],this.multiArray[1],this.toArr(o)],this.value=[this.value[0],s,0]}else if(2===t){var l=this.addressThree[s];console.log("选中的三级===",l.id),this.ADDressID=l.id,console.log(this.ADDressID)}},postAddressDatas:function(){var e=this,t=this;(0,a.publicing)(r.postAddressList).then((function(s){d(s.data),d(s),e.addressAllData=s.data,e.addressOne=e.getAddressByPId("0"),e.addressTwo=e.getAddressByPId(e.addressOne[0].id),e.addressThree=e.getAddressByPId(e.addressTwo[0].id),console.log(e.addressTwo[0].id),e.multiArray=[e.toArr(e.addressOne),e.toArr(e.addressTwo),e.toArr(e.addressThree)],console.log("获取全国一级地址===",e.addressOne),console.log("获取全国二级地址===",e.addressTwo),console.log("获取全国三级地址===",e.addressThree),t.getMerchants()})).catch((function(e){d(e)}))},getAddressByPId:function(e){for(var t=new Array,s=0;s<this.addressAllData.length;s++){var a=this.addressAllData[s];a.pId===e&&t.push(a)}return t},getAddressById:function(e){for(var t=0;t<this.addressAllData.length;t++){var s=this.addressAllData[t];if(s.id===e)return d(s),s}return null},uploadImages:function(e,t){this.flag=!0;var s=this;this.arrId.push(t),d(e),d(this.arrId);var a="";for(var i in this.arrId)a=a+this.arrId[i]+",";a=a.substring(0,a.length-1),this.idArrList=a,console.log(this.idArrList),(0,r.uploadFiles)((function(t){console.log(t.data),s.urlList[e].url=t.data,s.urlListFlag[e]=!0}))},postUpdateStore:function(t){d(t);var s=[{name:"storeName",rule:["required","isChinese","minLength:2","maxLength:20"],msg:["请输入店铺名称","店铺名必须全部为中文","姓名必须2个或以上字符","不能超过20个字符"]},{name:"merchantsName",rule:["required","isChinese","minLength:2","maxLength:6"],msg:["请输入真实性名","姓名必须全部为中文","姓名必须2个或以上字符","不能超过6个字符"]},{name:"phone",rule:["required","isMobile"],msg:["请输入手机号","请输入正确的手机号"]},{name:"address",rule:["minLength:4"],msg:["请选择地区","请选择地区!!!","请选择地区!!!","请选择地区!!!!"]},{name:"addressDetails",rule:["required","isChinese","minLength:4","maxLength:30"],msg:["请填写详细地址","请填写详细地址!!!","请填写详细地址!!!","请填写详细地址!!!!"]}],i=t.detail.value,n=l.validation(i,s);if(n)e.showToast({title:n,icon:"none"});else{var o=new Array;for(var u in this.urlListFlag)this.urlListFlag[u]&&o.push(this.urlList[u]);if(console.log("修改的图片去除没修改的====",o.length),console.log("修改的图片去除没修改的====",o),o.length<1)return void e.showToast({title:"重新编辑至少需要上传1张图片！",icon:"none"});var c=e.getStorageSync("usermen"),h={storeName:t.detail.value.storeName,merchantsName:t.detail.value.merchantsName,phone:t.detail.value.phone,address:this.Address1,token:c,type:1,addressDetails:t.detail.value.addressDetails,fileUrls:JSON.stringify(o),delFileIds:this.idArrList};0==this.flag?(delete h.fileUrls,delete h.delFileIds,d("没有上传图片")):1==this.flag&&d("点击了上传图片"),d(h),(0,a.publicing)(r.postupdateClient,h).then((function(t){d(t),e.showModal({title:"提示",showCancel:!1,content:"".concat(t.data.msg),success:function(e){e.confirm?wx.switchTab({url:"../../pages/my/my",success:function(e){var t=getCurrentPages().pop();void 0!=t&&null!=t&&t.onLoad()}}):e.cancel&&(console.log("用户点击取消"),wx.switchTab({url:"../../pages/my/my",success:function(e){var t=getCurrentPages().pop();void 0!=t&&null!=t&&(t.onLoad(),this.getMerchants())}}))}})})).catch((function(e){d(e)}))}},getMerchants:function(){var t=this;console.log("获取申请店铺状态信息");var s=e.getStorageSync("usermen"),i={token:s};(0,a.listing)(r.getClient,i).then((function(e){d(e),t.ApproveStatus=e.data.data.approveStatus,d(t.ApproveStatus),t.StoreInfo=e.data.data,t.urlList=e.data.data.urlList,t.Address1=e.data.data.address,d(e.data.data);var s=t.getAddressById(t.StoreInfo.address);d(s);var a=t.getAddressById(s.pId),r=t.getAddressById(a.pId);t.textAddress=r.name+"/"+a.name+"/"+s.name,t.StoreInfo.address=t.textAddress,d(t.textAddress),d("查询")})).catch((function(e){d(e)}))},onPullDownRefresh:function(){this.postAddressDatas(),this.getMerchants(),d(i),console.log("refresh"),setTimeout((function(){e.stopPullDownRefresh()}),1e3)},postsaveStores:function(){var t=e.getStorageSync("usermen");d(t),d(data),e.showLoading({title:"提交中"}),(0,a.publicing)(r.postSaveStore,data).then((function(t){d(t),e.hideLoading(),e.showToast({title:"".concat(t.data.msg),icon:"none"})})).catch((function(e){d(e)}))},getToken:function(){var t=e.getStorageSync("usermen");d(t)},chooseImage:function(t){var s=this;s.files.length>=9?this.tui.toast("最多上传9张图片"):e.chooseImage({count:9-s.files.length,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){s.files=s.files.concat(e.tempFilePaths),console.log(s.files)}})},previewImage:function(t){e.previewImage({current:t.currentTarget.id,urls:this.files})},deleteImage:function(e){var t=e.index;this.files.splice(t,1)},formSubmit:function(t){var s=[{name:"storeName",rule:["required","isChinese","minLength:2","maxLength:6"],msg:["请输入店铺名姓名","姓名必须全部为中文","姓名必须2个或以上字符","姓名不能超过6个字符"]},{name:"mobile",rule:["required","isMobile"],msg:["请输入手机号","请输入正确的手机号"]}],a=t.detail.value,r=l.validation(a,s);r?e.showToast({title:r,icon:"none"}):e.showToast({title:"提交!",icon:"none"})},formReset:function(e){console.log("清空数据")}},onLoad:function(){this.postAddressDatas(),d(i),this.getMerchants()}};t.default=u}).call(this,s("543d")["default"])},e089:function(e,t,s){"use strict";s.r(t);var a=s("6eec"),r=s.n(a);for(var i in a)"default"!==i&&function(e){s.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},ff4e:function(e,t,s){"use strict";var a=s("0d35"),r=s.n(a);r.a}},[["365d","common/runtime","common/vendor"]]]);