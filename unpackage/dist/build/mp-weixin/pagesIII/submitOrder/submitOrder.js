(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesIII/submitOrder/submitOrder"],{"34ef":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=e("b3d7"),o=e("5c15"),i=(t.getStorageSync("usermen"),console),r=i.log,s={components:{},data:function(){return{payUrl:"",isTop:!0,ids:"",goodsData:[],hasCoupon:!0,insufficient:!1,show:!1,extraUserInfo:{},totalPrice:{},ids2:"",orderNumber:"",extraData:{},idList:"",url:"",name:"arrowright",unit:"rpx",size:32,color:"#000",margin:"0",isPaying:!1}},computed:{allGoodsNum:function(){var t=this.goodsData,n=0;return t.forEach((function(t){n+=t.number})),n}},methods:{clip:function(){t.setClipboardData({data:this.payUrl,success:function(){t.hideToast()}})},gtePayORderTel:function(){var n=this,e=t.getStorageSync("usermen"),i={id:this.ids,token:e};(0,a.publicing)(o.postSettle,i).then((function(e){if(e.data.code&&200!=e.data.code)return t.showToast({title:e.data.msg,icon:"none"}),void t.switchTab({url:"../../pages/my/my"});n.extraUserInfo=e.data.data.extraData.userInfo,n.goodsData=e.data.data.data,n.extraData=e.data.data.extraData})).catch((function(t){console.log(t)}))},gtePayORder:function(){var n=this,e=t.getStorageSync("usermen"),i={id:this.ids,token:e};(0,a.publicing)(o.postSettle,i).then((function(t){n.extraUserInfo=t.data.data.extraData.userInfo,n.goodsData=t.data.data.data,n.extraData=t.data.data.extraData;var e=n.goodsData.map((function(t){return t.id})),a="";for(var o in e)a=a+e[o]+",";a=a.substring(0,a.length-1),n.ids=a})).catch((function(t){console.log(t)}))},getQueryString:function(t,n){if(t)for(var e=t.split("?")[1]||"",a=e.split("&")||[],o=0;o<a.length;o++){var i=decodeURIComponent(a[o].split("=")[0]),r=decodeURIComponent(a[o].split("=")[1]);if(n===i)return r}else;},SubmitOrder:function(){var n=this;if(n.isPaying)return!1;n.isPaying=!0;var e=t.getStorageSync("usermen"),i={id:n.ids,token:e};(0,a.listing)(o.getSubmitOrder,i).then((function(a){if(a.data.code&&200!=a.data.code)return t.showToast({title:a.data.msg,icon:"none"}),void t.switchTab({url:"../../pages/my/my"});if(-1!==a.data.code){var o=a.data.data,i=o.payinfo,r=o.orderNumber;t.setClipboardData({data:i,success:function(){t.hideToast()}}),t.showModal({title:"提示",content:"确认支付",success:function(a){if(a.confirm)n.btnPay(),n.isPaying=!1,n.orderIng();else if(a.cancel)return n.isPaying=!1,n.cancelOrder(r,e),t.showToast({title:"订单已取消",icon:"none",duration:2e3}),n.orderIng(),void t.switchTab({url:"../../pages/my/my"})}})}else t.showToast({title:a.data.msg,icon:"none",duration:3e3})})).catch((function(t){r(t)}))},orderIng:function(){var n=this,e=t.getStorageSync("usermen"),i={token:e};(0,a.listing)(o.getCart,i).then((function(e){if(e.data.code&&200!=e.data.code)return t.showToast({title:e.data.msg,icon:"none"}),void t.switchTab({url:"../../pages/my/my"});var a=e.data.data;if(a){var o=0;a.forEach((function(t){t.list&&(o+=t.list.length)})),0!==a.length?t.setTabBarBadge({index:3,text:o+""}):t.removeTabBarBadge({index:3}),a.forEach((function(t){t.list.forEach((function(t){Object.assign(t,{selected:!1})}))})),n.orderObj=a}})).catch((function(t){r(t)}))},open:function(){this.$refs.popup.show()},chooseAddr:function(){t.navigateTo({url:"../address/address"})},cancelOrder:function(t,n){var e={token:n,orderNumber:t};(0,a.publicing)(o.postCancelOrder,e).then((function(t){console.log(t)}))},btnPay:function(n){t.showLoading({title:"支付中",duration:2e3}),t.reLaunch({url:"../PayOK/PayOK"})},popupClose:function(){this.show=!1}},onLoad:function(t){this.url=o.imgurl,this.ids=t.ids,this.gtePayORderTel();var n=getCurrentPages(),e=(n[n.length-1],n[n.length-2]);"/pages/order/order"===e.$page.fullPath?this.gtePayORder():e.$page.fullPath}};n.default=s}).call(this,e("543d")["default"])},"457e":function(t,n,e){"use strict";e.r(n);var a=e("34ef"),o=e.n(a);for(var i in a)"default"!==i&&function(t){e.d(n,t,(function(){return a[t]}))}(i);n["default"]=o.a},"50ad":function(t,n,e){"use strict";e.r(n);var a=e("7812"),o=e("457e");for(var i in o)"default"!==i&&function(t){e.d(n,t,(function(){return o[t]}))}(i);e("977c");var r,s=e("f0c5"),u=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);n["default"]=u.exports},6752:function(t,n,e){},7812:function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){return a}));var a={tuiListCell:function(){return e.e("components/tui-list-cell/tui-list-cell").then(e.bind(null,"155c"))},tuiButton:function(){return e.e("components/tui-button/tui-button").then(e.bind(null,"2652"))},wybPopup:function(){return e.e("components/wyb-popup/wyb-popup").then(e.bind(null,"4cc8"))}},o=function(){var t=this,n=t.$createElement;t._self._c},i=[]},"977c":function(t,n,e){"use strict";var a=e("6752"),o=e.n(a);o.a},aaea:function(t,n,e){"use strict";(function(t){e("54e5");a(e("66fd"));var n=a(e("50ad"));function a(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])}},[["aaea","common/runtime","common/vendor"]]]);